```powershell
# Define file paths
$mainCsvPath = 'main_data.csv'       # CSV containing main data with accessprofiles (id empty)
$idMappingCsvPath = 'id_mapping.csv' # CSV containing accessprofiles name and corresponding id

# Import CSV files
$mainData = Import-Csv -Path $mainCsvPath
$idMapping = Import-Csv -Path $idMappingCsvPath

# Create a lookup hashtable for name to id mapping
$idLookup = @{}
foreach ($entry in $idMapping) {
    $idLookup[$entry.name] = $entry.id
}

# Process each record in main data
foreach ($record in $mainData) {
    if ($record.accessprofiles) {
        # Convert accessprofiles JSON string to object
        $profiles = $null
        try {
            $profiles = $record.accessprofiles | ConvertFrom-Json
        } catch {
            Write-Warning "Failed to parse accessprofiles JSON for record: $($record)"
            continue
        }

        # For each profile, if id is empty, fill it from lookup
        foreach ($profile in $profiles) {
            if ([string]::IsNullOrEmpty($profile.id) -and $idLookup.ContainsKey($profile.name)) {
                $profile.id = $idLookup[$profile.name]
            }
        }

        # Convert back to JSON string
        $record.accessprofiles = $profiles | ConvertTo-Json -Depth 5
    }
}

# Convert entire main data to JSON payload
$jsonPayload = $mainData | ConvertTo-Json -Depth 10

# Output JSON payload to file
$jsonPayload | Out-File -FilePath 'output_payload.json' -Encoding utf8

# Also print JSON payload to console
Write-Host "# Output JSON payload"
Write-Host $jsonPayload

Write-Host "JSON payload created and saved to output_payload.json"
```
